<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Ticaret KDS | <%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="/css/style.css"> 
    <style>
        /* --- FIGMA DESIGN TOKENS --- */
        :root {
            --bg-dark: #0d1117;
            --bg-card: #1a1e27;
            --text-main: #ffffff;
            --text-muted: #c9d1d9;
            --accent-cyan: #00bcd4;
            --spacing-gap: 8px; /* Kartlar arasƒ± bo≈üluk */
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            overflow-x: hidden; /* Yatay scrollu engelle */
        }

        /* Sidebar Sabitleme */
        .sidebar {
            background-color: var(--bg-card);
            color: var(--text-muted);
            width: 200px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
            border-right: 1px solid #30363d;
        }

        /* Ana ƒ∞√ßerik Alanƒ± */
        .main-content {
             margin-left: 200px; /* Sidebar geni≈üliƒüi */
             padding: 15px; /* Sayfa kenar bo≈üluƒüu */
             max-width: calc(100% - 200px);
        }
        
        /* --- KOMPAKT GRID Sƒ∞STEMƒ∞ --- */
        .row-tight {
            display: flex;
            flex-wrap: wrap;
            margin-right: calc(var(--spacing-gap) * -0.5);
            margin-left: calc(var(--spacing-gap) * -0.5);
        }
        
        .col-tight {
            flex: 0 0 auto;
            width: 33.33333%; /* Tam 3'e b√∂l */
            padding-right: calc(var(--spacing-gap) * 0.5);
            padding-left: calc(var(--spacing-gap) * 0.5);
        }
        
        /* --- KART TASARIMI --- */
        .card-figma {
            background-color: var(--bg-card);
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            height: 100%; /* S√ºtun boyunca uza */
            display: flex;
            flex-direction: column;
        }

        /* KPI Kartƒ± (√áok K√º√ß√ºk) */
        .kpi-mini {
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            margin-bottom: var(--spacing-gap);
        }
        .kpi-mini h2 { font-size: 1.5rem; margin: 0; color: var(--text-main); }
        .kpi-mini p { font-size: 0.85rem; margin: 0; color: var(--accent-cyan); }

        /* ƒ∞√ßerik Ba≈ülƒ±klarƒ± */
        h5 { font-size: 1rem; font-weight: 600; margin-bottom: 5px; }
        p.desc { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 10px; }

        /* Liste ve Kontroller */
        .compact-list {
            max-height: 80px; /* √áok kƒ±sa liste */
            overflow-y: auto;
            margin-bottom: 10px;
            border: 1px solid #30363d;
            border-radius: 4px;
        }
        .list-group-item {
            background: transparent;
            color: var(--text-muted);
            border-bottom: 1px solid #30363d;
            padding: 4px 8px;
            font-size: 0.8rem;
        }

        .controls-area {
            margin-top: auto; /* En alta it */
            padding-top: 10px;
            border-top: 1px solid #30363d;
        }
        
        /* Form Elemanlarƒ± (K√º√ß√ºlt√ºlm√º≈ü) */
        label { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 2px; }
        .form-control-sm { 
            background-color: #0d1117; 
            border: 1px solid #30363d; 
            color: #fff; 
            font-size: 0.8rem;
        }
        .form-text { font-size: 0.65rem; color: #8b949e; margin-top: 1px; }
        
        /* Slider */
        .form-range::-webkit-slider-runnable-track { background: #495057; height: 4px; }
        .form-range::-webkit-slider-thumb { background: var(--accent-cyan); width: 12px; height: 12px; margin-top: -4px;}

        /* Buton */
        .btn-figma {
            background-color: rgba(0, 188, 212, 0.1);
            color: var(--accent-cyan);
            border: 1px solid var(--accent-cyan);
            font-size: 0.8rem;
            padding: 5px;
            width: 100%;
            transition: all 0.2s;
        }
        .btn-figma:hover {
            background-color: var(--accent-cyan);
            color: #000;
        }

    </style>
</head>
<body>

    <div class="sidebar p-3">
        <h5 class="text-info mb-4 ps-2">Sentinel DSS</h5>
        <div class="list-group list-group-flush">
            <a class="list-group-item list-group-item-action bg-transparent text-info border-0 py-1" href="/">Genel Bakƒ±≈ü</a>
            <a class="list-group-item list-group-item-action bg-transparent text-white border-0 py-1" href="/personel">Personel</a>
            <a class="list-group-item list-group-item-action bg-transparent text-white border-0 py-1" href="/lojistik">Lojistik</a>
            <a class="list-group-item list-group-item-action bg-transparent text-white border-0 py-1" href="/depo">Depo</a>
            <a class="list-group-item list-group-item-action bg-transparent text-white border-0 py-1" href="/maliyet">Maliyet</a>
        </div>
    </div>
    
    <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
                <h4 class="m-0 text-white">Operasyon Y√∂netimi</h4>
                <small class="text-muted">Canlƒ± Veri Baƒülantƒ±sƒ± Aktif</small>
            </div>
            <div class="card-figma kpi-mini" style="width: 250px;">
                <p>TOPLAM PERSONEL</p>
                <h2><%= personel_data.length %></h2> 
            </div>
        </div>

        <div class="row-tight">
            
            <div class="col-tight">
                <div class="card-figma">
                    <h5>üßë‚Äçüè≠ ƒ∞≈üg√ºc√º & Kapasite</h5>
                    <p class="desc">Mevcut vs Hedef Kapasite Analizi</p>
                    
                    <div id="personel-chart" class="mb-2"></div>
                    
                    <ul class="list-group compact-list"> 
                        <% personel_data.forEach(personel => { %>
                            <li class="list-group-item">
                                <%= personel.ad_soyad %> - <%= personel.rol %>
                            </li>
                        <% }); %>
                    </ul>

                    <div class="controls-area">
                        <form action="/" method="POST"> 
                            <div class="mb-2">
                                <label>Hedef Sipari≈ü</label> 
                                <input type="number" class="form-control form-control-sm" name="hedefSiparis" value="400">
                            </div>
                            <div class="mb-3">
                                <label>Ek Personel: <span id="personelLabel">0</span></label> 
                                <input type="range" class="form-range" name="yeniPersonel" min="-2" max="5" value="0" oninput="document.getElementById('personelLabel').innerText = this.value">
                            </div>
                            <button type="submit" class="btn btn-figma">Sim√ºle Et</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-tight">
                <div class="card-figma">
                    <h5>üöö Lojistik & Churn</h5>
                    <p class="desc">Kargo Hƒ±zƒ± ve M√º≈üteri Kaybƒ±</p>
                    
                    <div id="lojistik-chart" class="mb-2"></div>
                    
                    <div class="mb-2"></div> <div class="controls-area mt-auto">
                        <form action="/lojistik-simulasyon" method="POST"> 
                            <div class="mb-4"> <label>Hedef Kargo Hƒ±zƒ± (G√ºn): <span id="hizLabel">3</span></label>
                                <input type="range" class="form-range" name="hedefKargoHizi" min="1" max="5" value="3" oninput="document.getElementById('hizLabel').innerText = this.value">
                                <div class="form-text">D√º≈ü√ºk s√ºre = D√º≈ü√ºk Churn</div>
                            </div>
                            <button type="submit" class="btn btn-figma">Sim√ºle Et</button>
                        </form>
                    </div>
                </div>
            </div>

            <div class="col-tight">
                <div class="card-figma">
                    <h5>üì¶ Depo & ROI Yatƒ±rƒ±m</h5>
                    <p class="desc">Yatƒ±rƒ±m Geri D√∂n√º≈ü S√ºresi</p>
                    
                    <div id="roi-chart" class="mb-2"></div>

                    <div class="controls-area">
                        <form action="/depo-simulasyon" method="POST"> 
                            <div class="mb-2">
                                <label>Yatƒ±rƒ±m Tutarƒ± (‚Ç∫)</label>
                                <input type="number" class="form-control form-control-sm" name="yatirimMaliyeti" value="100000">
                            </div>
                            <div class="mb-3">
                                <label>Ek G√ºnl√ºk Sipari≈ü</label>
                                <input type="number" class="form-control form-control-sm" name="ekKapasite" value="50">
                            </div>
                            <button type="submit" class="btn btn-figma">Sim√ºle Et</button>
                        </form>
                    </div>
                </div>
            </div>

        </div> </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/script.js"></script>
    <script id="sim-data" type="application/json">
        <%- JSON.stringify(simResult) %>
    </script>
</body>
</html>